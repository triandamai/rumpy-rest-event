[
  {
    "$match": {
      "$or": [
        {
          "member_code": {
            "$eq": "67857cdb1dc4ebaa87a21c11"
          }
        },
        {
          "nfc_id": {
            "$eq": "67857cdb1dc4ebaa87a21c11"
          }
        }
      ],
      "$and": [
        {
          "deleted": false
        },
        {
          "branch_id": {
            "$eq": "6742c74a15e68b0e7ee06120"
          }
        }
      ]
    }
  },
  {
    "$lookup": {
      "from": "account",
      "localField": "created_by_id",
      "foreignField": "_id",
      "as": "created_by"
    }
  },
  {
    "$lookup": {
      "from": "coach",
      "localField": "coach_id",
      "foreignField": "_id",
      "as": "coach"
    }
  },
  {
    "$lookup": {
      "from": "file-attachment",
      "localField": "_id",
      "foreignField": "ref_id",
      "as": "profile_picture"
    }
  },
  {
    "$lookup": {
      "from": "member-subscription",
      "localField": "_id",
      "foreignField": "member_id",
      "as": "subscription"
    }
  },
  {
    "$lookup": {
      "from": "membership",
      "localField": "subscription.membership_id",
      "foreignField": "_id",
      "as": "membership"
    }
  },
  {
    "$unwind": {
      "path": "$created_by",
      "preserveNullAndEmptyArrays": true
    }
  },
  {
    "$unwind": {
      "path": "$coach",
      "preserveNullAndEmptyArrays": true
    }
  },
  {
    "$unwind": {
      "path": "$profile_picture",
      "preserveNullAndEmptyArrays": true
    }
  },
  {
    "$unwind": {
      "path": "$subscription",
      "preserveNullAndEmptyArrays": true
    }
  },
  {
    "$unwind": {
      "path": "$membership",
      "preserveNullAndEmptyArrays": true
    }
  },
  {
    "$limit": 1
  }
]